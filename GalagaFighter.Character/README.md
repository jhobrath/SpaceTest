# GalagaFighter.Character

This project handles the ship and effect selection phase of the Galaga Fighter game.

## Features

### **Ship Selection Phase**
Players can choose from 8 different ship variants:
- **Azure Wing**: Classic blue fighter with balanced performance
- **Crimson Hawk**: Aggressive red fighter with enhanced firepower  
- **Emerald Dart**: Swift green fighter built for speed
- **Void Hunter**: Mysterious purple fighter with stealth capabilities
- **Solar Flare**: Bright orange fighter powered by solar energy
- **Ice Phantom**: Cool cyan fighter with ice-based weapons
- **Lightning Strike**: Electric yellow fighter with rapid-fire capability
- **Ghost Ship**: Pristine white fighter with defensive capabilities
- **Rose Phantom**: Elegant pink fighter with precision targeting
- **Shadow Reaper**: Dark fighter with overwhelming destructive power

### **Effect Selection Phase**
After selecting ships, players choose their offensive augment effects:
- **Surprise Shot**: Randomly fires additional bullets during combat
- **Timed Barrage**: Periodically unleashes rapid-fire bullet bursts
- **Ricochet**: Bullets bounce off walls to hit enemies
- **Splitter**: Bullets split into multiple projectiles on impact
- *(4 more effects planned for future expansion)*

### **Core Features**
- **Two-Phase Selection**: Ship selection followed by effect selection
- **Two-Player Support**: Both players select simultaneously
- **Ship Stats**: Each ship has unique stats (Health, Speed, Fire Rate, Damage, Shield)
- **Visual Sprites**: Ships use MainShip.png with unique color tints
- **Effect Integration**: Selected effects integrate with Core game systems

## Controls

### Ship Selection Phase
**Player 1**: W/S to navigate, D to select, A to cancel  
**Player 2**: UP/DOWN to navigate, LEFT to select, RIGHT to cancel

### Effect Selection Phase  
**Player 1**: W/S to navigate, D to select, A to cancel  
**Player 2**: UP/DOWN to navigate, LEFT to select, RIGHT to cancel

### Final Phase
**Both Players Ready**: SPACE to start the game

## Project Structure

```
GalagaFighter.Character/
??? Models/
?   ??? Character.cs           # Ship data model with color properties
?   ??? OffensiveEffect.cs     # Effect models and selection state
??? Services/
?   ??? CharacterService.cs    # Ship data and business logic
?   ??? EffectService.cs       # Effect data and management
?   ??? ShipSpriteService.cs   # Ship sprite generation from MainShip.png
??? UI/
?   ??? CharacterSelectionUI.cs # Multi-phase UI rendering
??? Integration/
?   ??? CharacterSelectionIntegration.cs # Integration with main game
??? CharacterSelectionGame.cs  # Main game loop with phase management
??? Program.cs                 # Entry point

```

## Ship Generation

The ship sprites are generated by loading the MainShip.png from GalagaFighter.Core and applying **advanced visual enhancements** including palette swapping and procedural effect overlays. This creates ten unique variants with optional visual effects:

### **Enhanced Visual System**
- **Palette Swapping**: Only red pixels are replaced with new colors while preserving silver/black details
- **Visual Effect Overlays**: Procedural effects can be added on top for ProjectileEffects
- **Layered Rendering**: Base ship + palette swap + visual effects = stunning results

### **Ship Color Variants**
- **Azure Wing**: Red ? Sky Blue
- **Crimson Hawk**: Red ? Red (original)
- **Emerald Dart**: Red ? Lime Green  
- **Void Hunter**: Red ? Purple
- **Solar Flare**: Red ? Orange + **Explosive Effects** ??
- **Ice Phantom**: Red ? Cyan + **Ice Crystal Effects** ??
- **Lightning Strike**: Red ? Yellow
- **Ghost Ship**: Red ? White
- **Rose Phantom**: Red ? Pink
- **Shadow Reaper**: Red ? Dark Gray + **Stealth Effects** ??

### **Visual Effect Types**

#### **?? Ice Effects**
- Ice crystals growing on wing sides
- Frost overlay with crystalline highlights
- Six-pointed ice crystal formations
- Subtle frost speckles for texture

#### **?? Explosive Effects**
- Layered flame trails from engines
- Glowing weapon ports with energy cores
- Explosive vents on ship sides
- Enhanced engine exhaust with multiple flame layers

#### **??? Wood Effects**
- Wooden armor plating on wings
- Reinforcement bands with metal rivets
- Wood grain texture details
- Natural brown color variations

#### **?? Ninja Effects**
- Stealth field shimmer overlay
- Shadow outline effects
- Smoke trail particles
- Purple/violet stealth energy

#### **?? Mud Effects**
- Irregular mud splatters on hull
- Grime streaks with texture
- Battle-worn appearance
- Dirt accumulation patterns

#### **?? Magnet Effects**
- Circular magnetic field lines
- Pulsing energy cores on sides
- Magnetic pull particle indicators
- Electric blue energy visualization

### **Technical Implementation**

**Palette Swapping Process:**
- **Source**: MainShip.png (contains red, silver, and black colors)
- **Target**: Only red pixels are replaced with new colors
- **Preserved**: Silver and black areas remain unchanged
- **Method**: Pixel-level color replacement with brightness matching

**Visual Effect Rendering:**
- **Layered Composition**: Base ship ? Palette swap ? Effect overlay
- **Procedural Generation**: All effects drawn using Raylib primitives
- **Performance Optimized**: Effects rendered once and cached as textures
- **Scalable**: Effects scale proportionally with ship size

**Effect Integration:**
- **ProjectileEffect Mapping**: Automatically applies visual effects when ProjectileEffects are selected
- **Manual Override**: Ships can have base visual effects regardless of selected ProjectileEffect
- **Dynamic Switching**: Effects can change based on equipped ProjectileEffects

This system creates visually stunning ships that not only have unique color schemes but also dramatic visual effects that clearly communicate their special abilities to players!

## Effect System Integration

The selected effects integrate with GalagaFighter.Core's effect system:
- Effects are referenced by their full class names
- Selection results include both ship and effect data
- Effects modify player behavior through the EffectModifiers system

## Integration

This project integrates with the main GalagaFighter.Core game through:
- `CharacterSelectionResult` containing both ship and effect selections
- Backwards compatibility with existing character-only integration
- Direct references to Core effect classes

## Dependencies

- **.NET 8**: Target framework
- **Raylib-cs**: Graphics and input handling
- **Microsoft.Extensions.DependencyInjection**: Dependency injection (inherited from Core)
- **GalagaFighter.Core**: Reference to core game systems and effects